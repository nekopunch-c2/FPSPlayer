# FPSPlayer
This is a full-body first person player for Unity. It's coded using a hierarchical state machine. It currently has 7 superstates and 3 substates, as well as some stuff outside the state machine like camera movement, and a footstep sound system that works with with terrains (with the added benefit of texture sound blending) and normal meshes. All three substates are accessible when the superstates are active. In other words, you can walk, run or be idle while you are in any of the superstates, for example the grounded superstate.
Many situations are taken into account. Examples are: stairs and slopes (Usually, because the character controller's Move() function moves the character only horizontally, when on going down a slope or stairs the it will move a bit in said axis before it's affected by gravity, which is unrealistic. This system is smart and can recognize both scenarios, which are quite different), falling from different heights and at different horizontal speeds (the character will play different animations based on the highest point it was at before it started falling, as well as how fast the player is moving, resulting in smooth transitions), moving platform handling (the character controller component currently has no way of recognizing where the player is standing on, and if that spot is moving or not), and more!
# To be implemented
In the works are more states, such as swimming and more advanced movement, as well as IK features.
# How to use
Open with Unity. Add the following tags: Stairs, CameraFollow, CameraManager, MovingPlatform, TopOfLadder, BottomOfLadder, TopOfLadderPos, BottomOfLadderPos, TopOfLadderGetDownPos, BottomOfLadderGetDownPos; as well as the following layers: Ground, Player. There is a prefab that already works, but if you want to set up your own character it's quite simple: Create a PlayerRoot object, this will separately hold everything. Inside, add an empty object called PlayerBody. There, add the Character Controller and Audio Source components, as well as the PlayerStateMachine, PlayerInputHandler, CameraLook, HeadBobbing, and FootstepSounds scripts. Below this PlayerBody object, you want to put your rigged model with an Animator component and AnimationEventReciever script. To have further control over the animations, I chose to use rig constraints, and I also created an empty game object named HeadRotationAdjuster with a script called SpineOrientation which has a list of game objects in which you can add whichever bones you wish, I chose only the head because the animations I was using tilted it slightly. The script requires you to add an Object To Orientate To, whose rotation will be copied in every object of the list previously mentioned, I set this to the HeadRotationAdjuster empty object, but you can set it to whatever you want. Finally, there are a couple of places in PlayerStateMachine and CameraLook where you have to drag the PlayerRoot and and PlayerBody objects.
All that's left is the Main Camera and virtual cameras. Currently you need to create a main camera with a cinemachine brain component, and 4 virtual cameras and drag them to the HeadBobbing script, their priorities will be handled there. This is if you want different FOVs and effects for running, walking, standing and falling, if not just remove the HeadBobbing script and create only one VCam. Last is having the camera follow the character: create a CameraFollow empty game object, set it's tag to CameraFollow, add the CameraPositionUpdater script, and drag it to the necessary places under the CameraLook script. Create an empty game object and make it a child of the head bone of the model, and drag it to the Camera Socket in CameraPositionUpdater. This will make it so that the camera follows the movement of the head, giving a realistic effect. 
Done! As you can see, it's not hard to set up. There were some compromises that had to be made, but this was in order to keep everything decoupled, as well as organized, tidy and scalable.
